## 1.项目设计

### 1.1项目总体构成

在结构上，项目总体分为四个部分：初始化部分、静态文件部分、数据库操作部分、路由部分。

在功能上，项目分为两个部分：管理员部分和用户部分。

### 1.2引入的包

下面列举项目中引入的重要包及其作用：

mongodb：后台数据库

ejs：页面渲染

Koa：路由管理

fs：文件管理

### 1.3项目目录结构

static                 	      // 静态文件 -- 前后端页面
methods                     // 前后端数据库操作
	manage                  // 后台各个页面数据库操作方法
	public.js                  // 前端页面公共方法
	web.js                     // 前端页面方法 -- 方法
router                         // 全局路由目录 -- 接口汇总
	manage                  // 后台管理路由
	manage.js              // user管理路由
	web.js                     // user前端展示路由
middleware                // 中间件目录
	router.js                  // 用于验证各种路径
	service.js                 // 用于验证网站开启/关闭 
utils                             // 初始化文件
	authToken.js          // 验证token是否有效
	baseConnect.js      // mongodb连接
	config.js                  // 数据库配置参数设置
	initDataBase.js      // 数据库初始化

app.js                          // 项目主文件

## 2.数据库设计

系统的数据库表如下所示：

article_info：文章头部信息

article_list ：文章内容

config：显示在config页面中的预设好的内容(所以可以不足五条数据)

logs：管理员登陆日志表

message：留言及回复数据表

other：导航管理数据表

session1：session 记录表(用户)

session2：session 记录表(管理员)

​	session1、2随着系统的使用而改变，登陆时写入登陆用户数据，注销时从表中删除用户数据

user：用户数据表

video_info：视频内容结构数据表

video_list：视频播放源数据表

## 3.使用说明书

### 3.1如何运行

- 从 https://github.com/clrcjj/final/tree/master 链接中下载整个项目
- 打开项目文件，进入 utils 文件夹中(cd utils)，运行initDataBase.js文件(node initDataBase.js)，此时各张数据库表已创建好
- 退出 utils 目录(cd ..)，执行app.js文件(node app.js)

### 3.2界面展示

- ##### 用户界面

在浏览器地址栏输入 ip 地址或 localhost：/10802 即可进入用户界面

###### 1)项目首页

![image-20211226184717405](image-20211226184717405.png)

用户可以在各个分区浏览相应的视频或者资讯

(电视剧)

![image-20211226184846480](image-20211226184846480.png)

(电影)

![image-20211226184945963](image-20211226184945963.png)

(综艺)

![image-20211226185008428](image-20211226185008428.png)

(资讯)

![image-20211226185100297](image-20211226185100297.png)

(百万剪辑)

![image-20211226185128750](image-20211226185128750.png)

上述影视或资讯资源仅供测试时录入，下载本项目者可届时自行录入

###### 2)资源检索功能

![image-20211226185422565](image-20211226185422565.png)

###### 3)播放视频

![image-20211226185507438](image-20211226185507438.png)

###### 4)浏览资讯

![image-20211226185537375](image-20211226185537375.png)

某些资讯在管理员设置下会和影片相关联

![image-20211226185731264](image-20211226185731264.png)

上述功能都是在未登录状态下就可以使用。



###### 5)用户注册

![image-20211226190018403](image-20211226190018403.png)

此时注册了一个用户user8

![image-20211226190141049](image-20211226190141049.png)

###### 6)用户登陆

![image-20211226190215052](image-20211226190215052.png)

###### 7)个人中心

![image-20211226190248824](image-20211226190248824.png)

###### 8)修改昵称

![image-20211226190348862](image-20211226190348862.png)

###### 9)获取所有视频列(点击右上角搜索框旁的符号，可以根据头部导航分类检索)

![image-20211226190517846](image-20211226190517846.png)

在本站浏览过一些视频后会有浏览记录

![image-20211226190808225](image-20211226190808225.png)

###### 10)可清空浏览记录

![image-20211226190855518](image-20211226190855518.png)

###### 11)发表留言和评论

![image-20211226191055472](image-20211226191055472.png)



- ##### 管理员界面

在浏览器地址栏输入 localhost:10802/manage/index.html 或者 ip地址:10802/manage/index.html即可进入到管理员界面

![image-20211226191628012](image-20211226191628012.png)

然后输入用户名：root 密码：123456 即可登陆

![image-20211226191743725](image-20211226191743725.png)

###### 1)日志管理(可以看到各个管理员登陆日志)

![image-20211226192303090](image-20211226192303090.png)

###### 2)视频管理

![image-20211226192525326](image-20211226192525326.png)

###### 3)可以根据上部导航条进行已发布视频的筛选(开启轮播的视频)

![image-20211226192634174](image-20211226192634174.png)

###### 4)查看视频信息

![image-20211226192814483](image-20211226192814483.png)

![image-20211226192756209](image-20211226192756209.png)

###### 5)编辑视频来源

![image-20211226192839920](image-20211226192839920.png)

![image-20211226192853794](image-20211226192853794.png)

###### 6)编辑视频

新增一个视频test

![image-20211226193335094](image-20211226193335094.png)

![image-20211226193413485](image-20211226193413485.png)

![image-20211226193442936](image-20211226193442936.png)

可以在前台看到test视频(综艺中第一个视频)

![image-20211226193532959](image-20211226193532959.png)

###### 7)删除视频

![image-20211226193615074](image-20211226193615074.png)

![image-20211226193653715](image-20211226193653715.png)

###### 8)编辑文章

![image-20211226193901962](image-20211226193901962.png)

新增一篇题为test的文章，关联视频为冬至

在前台可以浏览这篇文章

![image-20211226194022725](image-20211226194022725.png)

![image-20211226194047168](image-20211226194047168.png)

###### 9)文章管理

查看文章信息

![image-20211226194601005](image-20211226194601005.png)

再次编辑文章

![image-20211226194622925](image-20211226194622925.png)

删除文章

![image-20211226194701010](image-20211226194701010.png)

###### 10)用户管理

添加用户

新增管理员

![image-20211226194939968](image-20211226194939968.png)

新增用户

![image-20211226195150389](image-20211226195150389.png)

![image-20211226195216427](image-20211226195216427.png)

删除用户admin3

![image-20211226195247197](image-20211226195247197.png)

###### 11)导航管理

![image-20211226195336455](image-20211226195336455.png)

可以新增导航、删除导航目录，还可以为导航目录排序、升级、降级

###### 12)消息管理

![image-20211226195530001](image-20211226195530001.png)

可以对用户留言进行管理

###### 13)广告刊登

![image-20211226195622225](image-20211226195622225.png)

可以在首页显示广告

###### 14)友链管理

![image-20211226195705064](image-20211226195705064.png)

为前台增设友情链接，并且可以对其进行修改和删除

###### 15)系统配置

![image-20211226195834317](image-20211226195834317.png)

![image-20211226195817328](image-20211226195817328.png)

可以对网站的一些基础信息进行修改，前一张图片中显示的文字与config数据库中的信息相匹配



## 4.开发日记

commit对应内容，不重要的提交没有列出

1. 测试git连接
2. 创建项目，npm相关包
3. 上传初始化数据库的语句 initDataase.js
4. mongo数据库的连接建立
5. static静态文件
6. 对于文章的增删改查操作
7. 对于广告的增删改查操作
8. 外链、日志等操作
9. 管理员登录界面验证
10. 对于视频、用户等对象的操作
11. 首页入口、其他操作
12. logo上传
13. 前端页面方法
14. 后台系统路由
15. 前端展示管理路由
16. 中间件目录
17. 错误纠正
18. bug修复
19. 前端页面修改
20. 一些图片资源的上传
21. 功能模块的调整
22. 项目说明
23. readme

## 项目部署



特此鸣谢cms管理系统作者
